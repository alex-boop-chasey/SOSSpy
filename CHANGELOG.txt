CHANGELOG.txt
SOSSpy Prototype - Development Log

================================================================================
2025-12-06T05:14:32+10:00
[SOSSpy] feat: (Core/Engine) add BatterySOSDetector pure engine

Files created/modified:
• SOSSpy/Core/Engine/BatterySOSDetector.swift

Summary:
Created pure function engine for Battery SOS detection. Implements isInSOS()
with logic: batteryPercent <= 20 AND distanceFromHomeKm > 50. No async, no
side effects, no OS types - pure deterministic function only.

================================================================================
2025-12-06T05:19:59+10:00
[SOSSpy] chore: (Project) add read-only documentation

Files created/modified:
• read-only-docs/Architecture_in_One_Page.txt
• read-only-docs/Commit_Message_Playbook.txt
• read-only-docs/Forbidden_List.txt
• read-only-docs/masterplan.txt
• read-only-docs/Mock_Strategy.txt
• read-only-docs/Naming_and_Conventions.txt
• read-only-docs/Prototype_Snapshot.txt
• read-only-docs/Test_Locations_and_Scenarios.txt
• read-only-docs/todo.txt
• read-only-docs/XcodeBuildMCP_Recipes.txt

Summary:
Added complete read-only documentation suite including master plan, architecture
guidelines, naming conventions, forbidden patterns, test scenarios, and commit
message format. These docs define the frozen rules for SOSSpy prototype development.

================================================================================
2025-12-06T05:42:28+10:00
[SOSSpy] test: (Core/Engine) add deterministic BatterySOSDetector unit tests

Files created/modified:
• SOSSpyTests/Core/Engine/BatterySOSDetectorTests.swift
• project.yml (added SOSSpyTests target)
• SOSSpy.xcodeproj/project.pbxproj (regenerated)

Summary:
Created 5 deterministic unit tests for BatterySOSDetector using frozen values from
Test_Locations_and_Scenarios.txt: test_SafeScenario, test_EdgeScenario,
test_ExactTriggerScenario, test_ClearTriggerScenario, test_HighBatteryScenario.
All tests passing (5/5). Tests mirror Core/Engine structure exactly.

================================================================================
2025-12-06T05:56:20+10:00
[SOSSpy] feat: (Core/Services) scaffold EVRoutingService protocol + Real + Mock

Files created/modified:
• SOSSpy/Core/Services/EVRouting/EVRoutingService.swift
• SOSSpy/Core/Services/EVRouting/RealEVRoutingService.swift
• SOSSpy/Core/Services/EVRouting/MockEVRoutingService.swift

Summary:
Scaffolded EVRoutingService protocol with calculateRoute() async function and
RoutePlan struct. RealEVRoutingService has temporary stub implementation
(Apple Maps integration comes later). MockEVRoutingService returns deterministic
Bargara short route values (11.4km, 20min). All three files follow protocol +
Real + Mock pattern from Naming_and_Conventions.txt.

================================================================================
2025-12-06T06:04:00+10:00
[SOSSpy] chore: (Project) add CHANGELOG with backfilled history

Files created/modified:
• CHANGELOG.txt

Summary:
Created CHANGELOG.txt and backfilled all previous work from commit history.
All future edits will append entries to this file following ISO date/time format
with one-line summary and file list per guidance documents.

================================================================================
2025-12-06T06:10:00+10:00
[SOSSpy] feat: (Core/Services) scaffold DistanceFromHomeService protocol + Real + Mock

Files created/modified:
• SOSSpy/Core/Services/Distance/DistanceFromHomeService.swift
• SOSSpy/Core/Services/Distance/RealDistanceFromHomeService.swift
• SOSSpy/Core/Services/Distance/MockDistanceFromHomeService.swift

Summary:
Scaffolded DistanceFromHomeService protocol with distanceFromHome() async function.
RealDistanceFromHomeService has temporary stub returning 10.0 (real calculation with
frozen Bundaberg coordinates comes later). MockDistanceFromHomeService returns
deterministic Bargara test distance (11.4km). No OS frameworks (CoreLocation/MapKit)
in this step - pure stubs only. Follows protocol + Real + Mock pattern.

================================================================================
2025-12-06T06:20:00+10:00
[SOSSpy] feat: (UI/ViewModels) add SOSViewModel + minimal SOSScreen scaffold

Files created/modified:
• SOSSpy/UI/ViewModels/SOSViewModel.swift
• SOSSpy/UI/Screens/SOSScreen.swift

Summary:
Created @Observable struct SOSViewModel with service injection (EVRoutingService,
DistanceFromHomeService). Exposes batteryPercent, currentLocation, distanceFromHomeKm,
and isSOS properties. Implements async updateState() that calls distanceService and
BatterySOSDetector engine. Created minimal SOSScreen with three Text rows showing
battery, distance, and SOS status. Follows struct ViewModel pattern from
Naming_and_Conventions. No MapKit/CoreLocation yet - pure stub services only.

================================================================================
2025-12-06T06:28:00+10:00
[SOSSpy] feat: (UI/ViewModels) add mock route preview to SOS screen

Files created/modified:
• SOSSpy/UI/ViewModels/SOSViewModel.swift
• SOSSpy/UI/Screens/SOSScreen.swift

Summary:
Added routePlan optional property to SOSViewModel and implemented loadRoutePreview()
async method that calls routingService.calculateRoute() with mock Bargara destination
coordinates. Updated SOSScreen to conditionally display route distance and travel time
when routePlan is available. Screen now calls both updateState() and loadRoutePreview()
in .task. Uses mock routing service only - no Apple Maps integration yet.

================================================================================
2025-12-06T06:52:00+10:00
[SOSSpy] feat: (App) set SOSScreen as application entry point using mock services

Files created/modified:
• SOSSpy/SOSSpyApp.swift
• SOSSpy/UI/ViewModels/SOSViewModel.swift
• SOSSpy/Core/Services/EVRouting/EVRoutingService.swift
• SOSSpy/Core/Services/EVRouting/MockEVRoutingService.swift
• SOSSpy/Core/Services/Distance/DistanceFromHomeService.swift
• SOSSpy/Core/Services/Distance/MockDistanceFromHomeService.swift
• SOSSpy.xcodeproj/project.pbxproj (regenerated)

Summary:
Replaced ContentView with SOSScreen as app entry point, injecting MockEVRoutingService
and MockDistanceFromHomeService. Made SOSViewModel @Observable @MainActor final class
for Swift concurrency compliance. Added Sendable conformance to all service protocols
and mock implementations to fix data race warnings. App now launches directly to SOS
screen with live mock data showing battery status, distance from home, and route preview.

================================================================================
2025-12-07T08:30:00+10:00
[SOSSpy] feat: (App) inject RealEVRoutingService for demo

Files created/modified:
• SOSSpy/SOSSpyApp.swift

Summary:
Switched from MockEVRoutingService to RealEVRoutingService in SOSSpyApp.swift.
App now uses real Apple Maps MKDirections for route calculation from current
location to Bargara destination. Still using MockDistanceFromHomeService for
distance calculation. Successfully built and tested on iPhone 17 Pro simulator.

================================================================================
2025-12-07T08:45:00+10:00
[SOSSpy] feat: (UI/Screens) use RealDistanceFromHomeService for demo run

Files created/modified:
• SOSSpy/SOSSpyApp.swift

Summary:
Switched from MockDistanceFromHomeService to RealDistanceFromHomeService in
SOSSpyApp.swift. App now uses real distance calculation from current location
to frozen Bundaberg home coordinates. Combined with RealEVRoutingService, the
app now has full real service integration for SOS detection demo.

================================================================================
2025-12-07T09:00:00+10:00
[SOSSpy] feat: (Core/Services) implement real distance-from-home calculation

Files created/modified:
• SOSSpy/Core/Services/Distance/RealDistanceFromHomeService.swift

Summary:
Implemented haversine formula for real distance calculation in
RealDistanceFromHomeService. Uses frozen Bundaberg home coordinates
(-24.8658, 152.3489) and calculates great-circle distance to current location.
Pure math implementation using Foundation only - no CoreLocation dependency.
Earth radius: 6371 km.

================================================================================
